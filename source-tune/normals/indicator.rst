常见指标
============

性能指标
--------

* redis: 并发请求数也就每秒 3-5 万(基于 Reactor 模式)
* nginx 负载均衡性能是 3-5 万左(基于 Reactor 模式)
* mc 的读取性能 3-5 万左右(基于 Reactor 模式)

* LVS 的性能是十万级，据说可达到 80 万 / 秒
* F5 性能是百万级，从 200 万 / 秒到 800 万 / 秒都有

* kafka 号称百万级, 百万级是集群性能
* zookeeper 写入读取 2 万以上
* http 请求访问大概在 1.5-2 万左右(HTTP get 操作访问一个简单页面测试结果)
* MySQL 的 TPS 和写入的数据有关::
    
    写入 k/v 数据，主键存储 k，上万TPS
    读取 k/v 数据，可以达到10万 QPS

    mysql 官网 benchmarks:
    https://www.mysql.com/why-mysql/benchmarks/
    单机 32users 并发只读近 40w+ qps，读写 10w+ qps
    说明:
        这个数据有误导性，要看具体的 SQL 语句和表结构，实际应用中一般不可能这么高
        这个数据是简单的 k/v 数据

* NoSQL量级一般都是上万，但和测试硬件测试用例相关

* 业务系统一个 TPS 接口的请求时间 10~50ms 是比较合理的，QPS 5~20ms 是比较合理的

理想情况下，性能测试的时候，CPU 能压到 80% 以上，此时的 TPS/QPS 就是峰值，如果 CPU 没压满，指标就上不去，就可能有优化的空间。
如果是业务系统，由于业务复杂度差异很大，有的每秒 500 请求可能就是高性能了，因此需要针对业务进行性能测试，确立性能基线，方便后续架构设计做比较

http 相关性能::

    Spring Boot 基于 HTTP 协议的，HTTP 协议本身的解析非常耗性能
        我们之前实测 Hello world，16 核或者 32 核的机器，单机 TPS 也就 1.5 万左右（核数增加对性能作用不大）


* 一般把日活转换为 pv，然后按 pv 计算 QPS

* 单台服务器性能一般是:

    企业用的线上物理服务器，如:
    16 核 16g
    32 核 16G
    与时俱进，现在基本都是 32 核 48g 内存

    云主机的性能可以按照同配置的物理机 80% 的性能来估算

内存, 磁盘指标
--------------

* 一个TCP套接字连接占用的内存做分析，大概占4KByte


传输速度
--------

* 线路传输的速度是毫秒级别::

    同一机房内部能够做到几毫秒；
    分布在不同地方的机房，传输耗时需要几十甚至上百毫秒
    例如:
        从广州机房到北京机房，稳定情况下 ping 延时大约是 50ms，不稳定情况下可能达到 1s 甚至更多


并发指标
--------

* 一台机器最多开65535个 port, 其中压测可用的 port 是 ``32768～65535`` ,也就是每个兵团的士兵可达到 ``32768`` 个
* 单机可以支持: C100K, C1000K, C1M, C10M, C20M
* 单进程文件句柄最大可以设置::
  
    即: 单个进程可分配的最大文件数
    在我们使用ulimit或limits.conf来设置时，如果要超过默认的1048576值时需要先增大nr_open值


    注: Linux 内核 2.6.25 以前，在内核里面宏定义是 1024*1024，最大只能是 100w（1048576）
    如果 Linux 内核大于 2.6.25 则可以设置更大值



pv/qps 计算
-----------

::

    pv = 日活 * 人均点击次数
    并发均值 = pv/86400
    并发峰值 = 并发均值 * N

::

    1. 响应时间（RT）
    2. 并发数（Concurrency）
    3. 吞吐量（TPS）

    吞吐量 = 并发数 / 平均响应时间


* 最⼤吞吐量： 可⽀持的带宽
* 最⼤并发连接数: 每秒连接的总数量，体现并发处理连接的能⼒

* CPS: 每秒新建连接数：每秒新建连接的数量，体现处理新增连接的能⼒
* PPS: 每秒处理包量: 每秒钟转发的包量，体现包转发速率
* QPS: Query Per Second(每秒请求数，一般指读取，TPS)
* TPS: Transactions Per Second(每秒事务数，一般指写入，QPS)

* 并发数：同一时刻的接收的访问数量，时间单位一般用秒，也可以用分钟和小时，常见有并发请求数，并发连接数
* 日活：每日活跃用户数，指当天来访问过系统的用户，同一用户，无论用户访问多少功能和页面都只算一个用户











